<!DOCTYPE html>
<html>
<head>
    <title>Visualizar CSV</title>
</head>
<body>
    <h1>Primeras 10 columnas del CSV</h1>
    <table border="1">
        <thead>
            <!-- Encabezados de las columnas -->
            <tr>
                <th>Gestion</th>
                <th>Mes</th>
                <th>Dia</th>
                <th>Dato T</th>
                <th>Dato H</th>
                <th>Dato P</th>
                <th>Dato FPF</th>
                <th>Estado</th>
                <!-- Agrega las columnas restantes aquí -->
            </tr>
        </thead>
        <tbody>
            <!-- Aquí se mostrarán los datos del CSV -->
        </tbody>
    </table>
</body>
<script>
    // URL del archivo CSV en OneDrive
    var csvUrl = "https://1drv.ms/x/s!Aiu6Hnb6v9wphfd40Gti5c4FxvxngA?e=TfFsJq";

    // Obtener la referencia a la tabla
    var table = document.querySelector("table tbody");

    // Realizar la solicitud para obtener el CSV
    fetch(csvUrl)
        .then(response => response.text())
        .then(data => {
            // Dividir el CSV en hojas (suponiendo que las hojas están separadas por saltos de línea)
            var sheets = data.split("\n\n"); // Ajusta esto según la estructura real del CSV
            
            // Iterar a través de las hojas
            for (var sheetIndex = 0; sheetIndex < sheets.length; sheetIndex++) {
                var sheetData = sheets[sheetIndex];
                var rows = sheetData.split("\n");
                
                // Crear una tabla para cada hoja
                var sheetTable = document.createElement("table");
                
                // Iterar a través de las filas y columnas
                for (var rowIndex = 0; rowIndex < rows.length; rowIndex++) {
                    var columns = rows[rowIndex].split(",");
                    var row = sheetTable.insertRow(-1);
                    
                    // Iterar a través de las primeras 10 columnas y agregarlas a la fila
                    for (var columnIndex = 0; columnIndex < 10; columnIndex++) {
                        var cell = row.insertCell(columnIndex);
                        cell.textContent = columns[columnIndex];
                    }
                }
                
                // Agregar la tabla al documento
                document.body.appendChild(sheetTable);
            }
        })
        .catch(error => console.error("Error al cargar el CSV:", error));
</script>

</html>
